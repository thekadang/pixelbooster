# ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

ë”ì¹´ë‹¹ í”½ì…€ë¶€ìŠ¤í„°ì˜ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ì‹œìŠ¤í…œ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     í´ë¼ì´ì–¸íŠ¸ (Electron)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚             Renderer Process (React)                   â”‚ â”‚
â”‚  â”‚  - UI ì»´í¬ë„ŒíŠ¸                                         â”‚ â”‚
â”‚  â”‚  - ì‚¬ìš©ì ì¸í„°ë™ì…˜                                     â”‚ â”‚
â”‚  â”‚  - ìƒíƒœ ê´€ë¦¬                                           â”‚ â”‚
â”‚  â”‚  - ê²°ì œ UI (Stripe Checkout)                          â”‚ â”‚  â­
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â†• IPC                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚             Main Process (Node.js)                     â”‚ â”‚
â”‚  â”‚  - ImageProcessor (Sharp)                              â”‚ â”‚
â”‚  â”‚  - FileSystem ì ‘ê·¼                                     â”‚ â”‚
â”‚  â”‚  - LogManager (Excel)                                  â”‚ â”‚
â”‚  â”‚  - BackupManager                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â†•                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚             Services                                   â”‚ â”‚
â”‚  â”‚  - SubscriptionManager (êµ¬ë… ê²€ì¦, ìºì‹±)               â”‚ â”‚
â”‚  â”‚  - DeviceManager (ê¸°ê¸° ì¸ì¦)                           â”‚ â”‚
â”‚  â”‚  - AuthService (JWT í† í° ê´€ë¦¬)                         â”‚ â”‚
â”‚  â”‚  - I18nManager (ë‹¤êµ­ì–´)                                â”‚ â”‚
â”‚  â”‚  - FeatureFlagManager (ê¸°ëŠ¥ í”Œë˜ê·¸) â­                 â”‚ â”‚
â”‚  â”‚  - EventBus (ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ ) â­                      â”‚ â”‚
â”‚  â”‚  - PluginRegistry (í”ŒëŸ¬ê·¸ì¸ ê´€ë¦¬) â­                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†• HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Supabase (BaaS)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Auth (JWT)          PostgreSQL DB      Edge Functions â”‚ â”‚
â”‚  â”‚  - íšŒì›ê°€ì…/ë¡œê·¸ì¸    - ì‚¬ìš©ì ì •ë³´     - ê¸°ê¸° ì¸ì¦     â”‚ â”‚
â”‚  â”‚  - í† í° ê´€ë¦¬         - êµ¬ë… ì •ë³´       - êµ¬ë… ê²€ì¦     â”‚ â”‚
â”‚  â”‚  - ì´ë©”ì¼ ì¸ì¦ â­    - ê¸°ê¸° ì •ë³´       - ìˆ˜ìˆ˜ë£Œ ê³„ì‚°   â”‚ â”‚
â”‚  â”‚                      - êµ¬ë… ë“±ê¸‰ â­    - Stripe Webhookâ”‚ â”‚
â”‚  â”‚                      - í”¼ì²˜ í”Œë˜ê·¸ â­  - ê²°ì œ ì„¸ì…˜ ìƒì„±â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†• HTTPS                      â†• Webhook
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Stripe Payment Gateway  â”‚   â”‚   ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (Web)      â”‚
â”‚  - Checkout Session      â”‚   â”‚  - ì‚¬ìš©ì ê´€ë¦¬               â”‚
â”‚  - Subscription ê´€ë¦¬     â”‚   â”‚  - ìˆ˜ìµ í†µê³„                 â”‚
â”‚  - Webhook Events        â”‚   â”‚  - ì–´í•„ë¦¬ì—ì´íŠ¸ ê´€ë¦¬         â”‚
â”‚  - ê²°ì œ ì²˜ë¦¬             â”‚   â”‚  - í”¼ì²˜ í”Œë˜ê·¸ ê´€ë¦¬ â­       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  - A/B í…ŒìŠ¤íŠ¸ ê´€ë¦¬ â­        â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**â­ = ì‹ ê·œ ì¶”ê°€/ì—…ë°ì´íŠ¸ëœ ì»´í¬ë„ŒíŠ¸**

---

## í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°

```
thekadang_pixelbooster/
â”œâ”€â”€ docs/                           # ğŸ“š ë¬¸ì„œ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ architecture/               # ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”‚   â”œâ”€â”€ features/                   # ê¸°ëŠ¥ ìƒì„¸ ë¬¸ì„œ
â”‚   â”œâ”€â”€ development/                # ê°œë°œ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ api/                        # API ëª…ì„¸
â”‚   â””â”€â”€ deployment/                 # ë°°í¬ ê°€ì´ë“œ
â”‚
â”œâ”€â”€ client/                         # ğŸ’» ë°ìŠ¤í¬í†± ì•± (Electron)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/                  # Main Process
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts           # Electron ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ core/              # í•µì‹¬ ë¡œì§
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ImageProcessor.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LogManager.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BackupManager.ts
â”‚   â”‚   â”‚   â””â”€â”€ services/          # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”‚       â”œâ”€â”€ SubscriptionManager.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ DeviceManager.ts
â”‚   â”‚   â”‚       â””â”€â”€ AuthService.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ renderer/              # Renderer Process (React)
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ components/        # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HeaderBar.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DropZone.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SettingsPanel.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ProgressBar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/             # í˜ì´ì§€
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainPage.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LoginPage.tsx
â”‚   â”‚   â”‚   â””â”€â”€ hooks/             # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config/                # ì„¤ì •
â”‚   â”‚   â”‚   â””â”€â”€ app-config.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ locales/               # ë‹¤êµ­ì–´ ë¦¬ì†ŒìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ ko.json
â”‚   â”‚   â”‚   â””â”€â”€ en.json
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ types/                 # íƒ€ì… ì •ì˜
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ electron-builder.config.js
â”‚
â”œâ”€â”€ server/                         # ğŸŒ ì„œë²„ (Supabase)
â”‚   â””â”€â”€ supabase/
â”‚       â”œâ”€â”€ functions/             # Edge Functions
â”‚       â”‚   â”œâ”€â”€ login-with-device-check/
â”‚       â”‚   â”œâ”€â”€ check-subscription/
â”‚       â”‚   â”œâ”€â”€ register-device/
â”‚       â”‚   â”œâ”€â”€ track-referral/
â”‚       â”‚   â”œâ”€â”€ process-commission/
â”‚       â”‚   â”œâ”€â”€ create-checkout-session/ â­  # Stripe ê²°ì œ ì„¸ì…˜ ìƒì„±
â”‚       â”‚   â”œâ”€â”€ webhook-stripe/          â­  # Stripe Webhook ì²˜ë¦¬
â”‚       â”‚   â””â”€â”€ cancel-subscription/     â­  # êµ¬ë… ì·¨ì†Œ
â”‚       â”‚
â”‚       â””â”€â”€ migrations/            # DB ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚           â”œâ”€â”€ 20251110_initial_schema.sql
â”‚           â”œâ”€â”€ 20251110_subscription_tiers.sql    â­
â”‚           â”œâ”€â”€ 20251110_feature_flags.sql         â­
â”‚           â””â”€â”€ seed.sql
â”‚
â”œâ”€â”€ admin/                          # ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (Web)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ UserManagement.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ RevenueManagement.tsx
â”‚   â”‚   â”‚   â””â”€â”€ AffiliateManagement.tsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ shared/                         # ğŸ”„ ê³µí†µ ì½”ë“œ
â”‚   â”œâ”€â”€ types/                     # ê³µí†µ íƒ€ì…
â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ subscription.ts
â”‚   â”‚   â””â”€â”€ device.ts
â”‚   â””â”€â”€ utils/                     # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚
â”œâ”€â”€ CLAUDE.md                       # ğŸ“Œ ë¬¸ì„œ í—ˆë¸Œ
â”œâ”€â”€ task.md                         # ğŸ“‹ ì§„í–‰ ìƒí™©
â”œâ”€â”€ ê¸°íšì„œ.md                       # ğŸ“„ ê¸°íš ë¬¸ì„œ
â”œâ”€â”€ ê¸°ìˆ ì ê³„íš.md                   # ğŸ“„ ê¸°ìˆ  ê³„íš
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ package.json                    # ë£¨íŠ¸ workspace ì„¤ì •
```

---

## í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ì„¤ëª…

### í´ë¼ì´ì–¸íŠ¸ (Electron)

#### Main Process
- **ImageProcessor**: Sharp ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ì´ë¯¸ì§€ ë³€í™˜
- **LogManager**: ExcelJSë¥¼ ì‚¬ìš©í•œ ì‘ì—… ë¡œê·¸ ìƒì„±
- **BackupManager**: ì›ë³¸ íŒŒì¼ ë°±ì—… ì²˜ë¦¬
- **SubscriptionManager**: êµ¬ë… ë“±ê¸‰ ê´€ë¦¬ ë° ê¸°ëŠ¥ ì œí•œ
- **DeviceManager**: ê¸°ê¸° ê³ ìœ  ID ìƒì„± ë° ì¸ì¦
- **AuthService**: Supabase ì¸ì¦ ì²˜ë¦¬

#### Renderer Process (React)
- **UI ì»´í¬ë„ŒíŠ¸**: ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
- **ìƒíƒœ ê´€ë¦¬**: ì•± ìƒíƒœ ë° ì§„í–‰ ìƒí™©
- **IPC í†µì‹ **: Main Processì™€ì˜ ë°ì´í„° êµí™˜

### ì„œë²„ (Supabase)

#### Auth
- JWT ê¸°ë°˜ ì¸ì¦
- ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸

#### PostgreSQL DB
- ì‚¬ìš©ì ì •ë³´
- êµ¬ë… ì •ë³´
- ê¸°ê¸° ë“±ë¡ ì •ë³´
- ì–´í•„ë¦¬ì—ì´íŠ¸ ë°ì´í„°

#### Edge Functions
- ì»¤ìŠ¤í…€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- ê¸°ê¸° ì¸ì¦ ì²˜ë¦¬
- ìˆ˜ìˆ˜ë£Œ ê³„ì‚°

### ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (Web)
- React ê¸°ë°˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- ì‚¬ìš©ì/ìˆ˜ìµ/ì–´í•„ë¦¬ì—ì´íŠ¸ ê´€ë¦¬

---

## ë°ì´í„° íë¦„

### 1. ì´ë¯¸ì§€ ë³€í™˜ í”„ë¡œì„¸ìŠ¤ (ì—…ë°ì´íŠ¸ â­)
```
1. ì‚¬ìš©ì íŒŒì¼ ì„ íƒ (Renderer)
   â†“
2. êµ¬ë… ë“±ê¸‰ í™•ì¸ (SubscriptionManager)
   - ìºì‹œ í™•ì¸ (1ì‹œê°„ TTL)
   - ë§Œë£Œ ì²´í¬ (expires_at)
   - í¬ë§· ì§€ì› í™•ì¸ (subscription_tiers.features)
   â†“
3. ì „ëµ íŒ¨í„´ ì ìš© (ISubscriptionStrategy)
   - validateConversion() í˜¸ì¶œ
   - Free: 10ê°œ, WebPë§Œ
   - Basic: 50ê°œ, WebP + AVIF
   - Pro: 200ê°œ, ëª¨ë“  í¬ë§·
   â†“
4. IPCë¥¼ í†µí•´ Main Processë¡œ ì „ë‹¬
   â†“
5. í”ŒëŸ¬ê·¸ì¸ ì„ íƒ (PluginRegistry)
   - findConverter(inputFormat, outputFormat)
   â†“
6. ImageProcessorë¡œ ë°°ì¹˜ ì²˜ë¦¬
   - ì´ë²¤íŠ¸ ë°œí–‰: 'conversion:started'
   - ì´ë²¤íŠ¸ ë°œí–‰: 'conversion:progress'
   â†“
7. ì§„í–‰ ìƒíƒœë¥¼ Rendererë¡œ ì „ì†¡ (EventBus)
   â†“
8. í›„ì²˜ë¦¬ (Strategy.postProcess())
   - BackupManager (Basic ì´ìƒ)
   - LogManager (Basic ì´ìƒ)
   - AnalyticsService (Pro)
   â†“
9. ì´ë²¤íŠ¸ ë°œí–‰: 'conversion:completed'
   â†“
10. ì™„ë£Œ ì•Œë¦¼
```

### 2. ì¸ì¦ í”„ë¡œì„¸ìŠ¤ (ì—…ë°ì´íŠ¸ â­)
```
1. ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œë„ (Renderer)
   â†“
2. ì´ë©”ì¼ ì¸ì¦ í™•ì¸ â­
   - email_confirmed_at ì²´í¬
   - ë¯¸ì¸ì¦ ì‹œ ì¸ì¦ ì´ë©”ì¼ ì¬ë°œì†¡
   â†“
3. ê¸°ê¸° ID ìƒì„±/ì¡°íšŒ (DeviceManager)
   - machineIdSync() í˜¸ì¶œ
   - í•´ì‹œ ìƒì„±
   â†“
4. Supabase Edge Function í˜¸ì¶œ
   - login-with-device-check
   â†“
5. ê¸°ê¸° ë“±ë¡ ìˆ˜ í™•ì¸
   - devices í…Œì´ë¸” ì¡°íšŒ
   - ë“±ê¸‰ë³„ í•œë„ ì²´í¬ (Free:2, Basic:3, Pro:5)
   â†“
6. Rate Limiting í™•ì¸ â­
   - ë¡œê·¸ì¸ ì‹œë„: 5íšŒ/ë¶„
   - IP ê¸°ë°˜ ì²´í¬
   â†“
7. ì¸ì¦ ì„±ê³µ ì‹œ í† í° ì €ì¥ (SecureStorage)
   - machine-id ê¸°ë°˜ ì•”í˜¸í™”
   â†“
8. êµ¬ë… ì •ë³´ ì¡°íšŒ (SubscriptionManager)
   - subscription_tiers ì¡°ì¸
   - features JSONB íŒŒì‹±
   â†“
9. í”¼ì²˜ í”Œë˜ê·¸ ì¡°íšŒ (FeatureFlagManager) â­
   - feature_flags í…Œì´ë¸”
   - user_feature_flags ì˜¤ë²„ë¼ì´ë“œ ì²´í¬
   â†“
10. ì´ë²¤íŠ¸ ë°œí–‰: 'auth:success'
   â†“
11. ë©”ì¸ í™”ë©´ í‘œì‹œ
```

### 3. ê²°ì œ í”„ë¡œì„¸ìŠ¤ (ì‹ ê·œ â­)
```
1. ì‚¬ìš©ì "ì—…ê·¸ë ˆì´ë“œ" ë²„íŠ¼ í´ë¦­ (Renderer)
   â†“
2. Edge Function í˜¸ì¶œ: create-checkout-session
   - ì‚¬ìš©ì ID, ì„ íƒí•œ ë“±ê¸‰ ì „ë‹¬
   â†“
3. Stripe Checkout Session ìƒì„±
   - Price ID ì¡°íšŒ
   - Customer ìƒì„±/ì¡°íšŒ
   - success_url, cancel_url ì„¤ì •
   â†“
4. Checkout URL ë°˜í™˜
   â†“
5. ë¸Œë¼ìš°ì €ì—ì„œ Stripe Checkout ì—´ê¸°
   - ì‚¬ìš©ìê°€ ê²°ì œ ì •ë³´ ì…ë ¥
   â†“
6. Stripeì—ì„œ ê²°ì œ ì²˜ë¦¬
   â†“
7. Stripe Webhook ì „ì†¡ â†’ Edge Function: webhook-stripe
   - Event: checkout.session.completed
   - ì„œëª… ê²€ì¦ (Stripe Secret)
   â†“
8. DB ì—…ë°ì´íŠ¸ (subscriptions í…Œì´ë¸”)
   - tier, status='active' ì—…ë°ì´íŠ¸
   - expires_at, stripe_customer_id, stripe_subscription_id ì„¤ì •
   â†“
9. ì´ë²¤íŠ¸ ê¸°ë¡ (user_events í…Œì´ë¸”)
   - event_type: 'subscription_upgraded'
   â†“
10. í´ë¼ì´ì–¸íŠ¸ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (success_url)
   â†“
11. SubscriptionManager ìºì‹œ ë¬´íš¨í™”
   â†“
12. ì´ë²¤íŠ¸ ë°œí–‰: 'subscription:changed'
   - LogManager, AnalyticsService ë¦¬ìŠ¤ë„ˆ ë°˜ì‘
   â†“
13. UI ì—…ë°ì´íŠ¸ (ìƒˆ ê¸°ëŠ¥ í™œì„±í™”)
```

### 4. êµ¬ë… ë§Œë£Œ ì²˜ë¦¬ (ì‹ ê·œ â­)
```
1. SubscriptionManager.checkSubscription() í˜¸ì¶œ
   â†“
2. expires_at í™•ì¸
   - ë§Œë£Œë˜ì—ˆëŠ”ì§€ ì²´í¬
   â†“
3. ë§Œë£Œëœ ê²½ìš°
   â†“
4. DB ì—…ë°ì´íŠ¸
   - status='expired'
   â†“
5. ì´ë²¤íŠ¸ ë°œí–‰: 'subscription:expired'
   â†“
6. UI ì•Œë¦¼ í‘œì‹œ
   - "êµ¬ë…ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê°±ì‹ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
   â†“
7. Free ë“±ê¸‰ ê¸°ëŠ¥ìœ¼ë¡œ ì œí•œ
   - ê¸°ì¡´ ìºì‹œ ë¬´íš¨í™”
   - Free Strategy ì ìš©
```

### 5. Stripe Webhook ì´ë²¤íŠ¸ ì²˜ë¦¬ (ì‹ ê·œ â­)
```
webhook-stripe Edge Functionì´ ì²˜ë¦¬í•˜ëŠ” ì´ë²¤íŠ¸:

1. checkout.session.completed
   â†’ êµ¬ë… í™œì„±í™” (status='active')

2. invoice.payment_succeeded
   â†’ expires_at ì—°ì¥ (1ê°œì›”)

3. invoice.payment_failed
   â†’ status='suspended', ì´ë©”ì¼ ì•Œë¦¼

4. customer.subscription.deleted
   â†’ status='cancelled', expires_at ì„¤ì •

5. customer.subscription.updated
   â†’ tier ë³€ê²½ (ì—…ê·¸ë ˆì´ë“œ/ë‹¤ìš´ê·¸ë ˆì´ë“œ)
```

---

## ê¸°ìˆ  ìŠ¤íƒ

### í´ë¼ì´ì–¸íŠ¸
- **í”„ë ˆì„ì›Œí¬**: Electron 28+
- **UI**: React 18+ with TypeScript
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: Sharp
- **Excel**: ExcelJS
- **ë‹¤êµ­ì–´**: i18next
- **ìƒíƒœ ê´€ë¦¬**: React Context API
- **ìŠ¤íƒ€ì¼ë§**: Tailwind CSS / CSS Modules

### ì„œë²„
- **BaaS**: Supabase
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL
- **ì¸ì¦**: Supabase Auth (JWT)
- **ì„œë²„ë¦¬ìŠ¤**: Deno (Edge Functions)

### ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
- **í”„ë ˆì„ì›Œí¬**: React 18+
- **ë¼ìš°íŒ…**: React Router
- **UI ë¼ì´ë¸ŒëŸ¬ë¦¬**: Material-UI / Ant Design
- **ì°¨íŠ¸**: Recharts

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ (ì—…ë°ì´íŠ¸ â­)

### ê¸°ë³¸ ë³´ì•ˆ
1. **í†µì‹  ì•”í˜¸í™”**: ëª¨ë“  API í†µì‹ ì€ HTTPS
2. **í† í° ê´€ë¦¬**: JWT í† í°ì„ SecureStorageì— ì•”í˜¸í™” ì €ì¥
3. **RLS**: Supabase Row Level Security í™œì„±í™” (ëª¨ë“  í…Œì´ë¸”)
4. **ê¸°ê¸° ì¸ì¦**: ë“±ê¸‰ë³„ ê¸°ê¸° ë“±ë¡ ìˆ˜ ì œí•œ (Free:2, Basic:3, Pro:5)
5. **í™˜ê²½ ë³€ìˆ˜**: API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬

### Electron ì•± ë³´ì•ˆ â­
6. **ì½”ë“œ ë‚œë…í™”**: webpack-obfuscatorë¡œ ì†ŒìŠ¤ì½”ë“œ ë³´í˜¸
7. **API í‚¤ ë³´í˜¸**: í™˜ê²½ ë³€ìˆ˜ + Electron Store ì•”í˜¸í™”
8. **ë³´ì•ˆ ì €ì¥ì†Œ**: electron-store + machine-id ê¸°ë°˜ ì•”í˜¸í™”
9. **CSP**: Content Security Policy ì„¤ì •
10. **nodeIntegration: false**: Rendererì—ì„œ Node.js ì ‘ê·¼ ì°¨ë‹¨

### API ë³´ì•ˆ â­
11. **Rate Limiting**: ì—”ë“œí¬ì¸íŠ¸ë³„ ìš”ì²­ ì œí•œ
    - ë¡œê·¸ì¸: 5íšŒ/ë¶„
    - êµ¬ë… í™•ì¸: 60íšŒ/ë¶„
    - ê¸°ê¸° ë“±ë¡: 3íšŒ/ì‹œê°„
    - ë³€í™˜ ìš”ì²­: 100íšŒ/ë¶„

12. **ì´ë©”ì¼ ì¸ì¦**: íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ ì¸ì¦ í•„ìˆ˜
13. **ì¼íšŒìš© ì´ë©”ì¼ ì°¨ë‹¨**: disposable email ë„ë©”ì¸ ë¸”ë™ë¦¬ìŠ¤íŠ¸

### ê²°ì œ ë³´ì•ˆ â­
14. **Webhook ì„œëª… ê²€ì¦**: Stripe Webhook Signature í•„ìˆ˜ ê²€ì¦
15. **ì„œë²„ ì‚¬ì´ë“œ ê²€ì¦**: ëª¨ë“  ê²°ì œ ì •ë³´ëŠ” ì„œë²„ì—ì„œ ê²€ì¦
16. **ê°€ê²© ì¡°ì‘ ë°©ì§€**: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ê°€ê²© ì „ì†¡ ê¸ˆì§€, Price IDë§Œ ì „ì†¡
17. **ë©±ë“±ì„± ë³´ì¥**: ì¤‘ë³µ ê²°ì œ ë°©ì§€ (Stripe idempotency key)

### ì–´ë·°ì§• ë°©ì§€ â­
18. **ê¸°ê¸° ID ë³€ì¡° ë°©ì§€**: Hardware UUID + ì„œë²„ ê²€ì¦
19. **íŒ¨í„´ ê°ì§€**: user_events í…Œì´ë¸” ë¶„ì„ìœ¼ë¡œ ì˜ì‹¬ í™œë™ íƒì§€
20. **abuse_prevention í…Œì´ë¸”**: ì˜ì‹¬ í™œë™ ìë™ ê¸°ë¡ ë° ì•Œë¦¼

ìƒì„¸í•œ ë³´ì•ˆ ì„¤ê³„ëŠ” [security-architecture.md](./security-architecture.md) ì°¸ì¡°

---

## í™•ì¥ì„± ê³„íš

### ì¸í”„ë¼ í™•ì¥
1. **ì´ˆê¸°**: Supabase ë¬´ë£Œ í”Œëœ (25K MAU, 500MB DB, 1GB íŒŒì¼)
2. **ì„±ì¥**: Supabase Pro í”Œëœ ($25/ì›”, 100K MAU, 8GB DB, 100GB íŒŒì¼)
3. **ëŒ€ê·œëª¨**: Supabase Team/Enterprise ë˜ëŠ” AWS/GCPë¡œ ì´ì „
   - PostgreSQL í‘œì¤€ ì‚¬ìš©ìœ¼ë¡œ ì‰¬ìš´ ë§ˆì´ê·¸ë ˆì´ì…˜
   - Read Replicas ì¶”ê°€
   - CDN ì—°ë™ (ì •ì  ìì‚°)

### ê¸°ëŠ¥ í™•ì¥ (ì‹ ê·œ â­)
4. **í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜**: ìƒˆ ë³€í™˜ê¸°ë¥¼ ì½”ë“œ ìˆ˜ì • ì—†ì´ ì¶”ê°€ ê°€ëŠ¥
5. **í”¼ì²˜ í”Œë˜ê·¸ ì‹œìŠ¤í…œ**: ì½”ë“œ ë°°í¬ ì—†ì´ ê¸°ëŠ¥ ì¼œê³  ë„ê¸°
6. **ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜**: ëª¨ë“ˆ ê°„ ê²°í•©ë„ ìµœì†Œí™”
7. **ì „ëµ íŒ¨í„´**: êµ¬ë… ë“±ê¸‰ë³„ ë™ì‘ì„ if/else ì—†ì´ ê´€ë¦¬
8. **Configuration as Data**: í•˜ë“œì½”ë”© ì œê±°, DBë¡œ ì„¤ì • ê´€ë¦¬

### ë¯¸ë˜ í™•ì¥ ì‹œë‚˜ë¦¬ì˜¤
9. **í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€**: Dropbox, Google Drive, OneDrive ì—°ë™
10. **AI ê¸°ëŠ¥**: Real-ESRGAN ê¸°ë°˜ ì—…ìŠ¤ì¼€ì¼ë§, ë…¸ì´ì¦ˆ ì œê±°
11. **ë°°ì¹˜ ìŠ¤ì¼€ì¤„ë§**: cron ê¸°ë°˜ ìë™ ë³€í™˜ ì‘ì—…
12. **íŒ€ êµ¬ë…**: ë©€í‹° ìœ ì € ì§€ì›, íŒ€ ê´€ë¦¬ ê¸°ëŠ¥
13. **í”ŒëŸ¬ê·¸ì¸ ë§ˆì¼“í”Œë ˆì´ìŠ¤**: ì„œë“œíŒŒí‹° í™•ì¥ ìƒíƒœê³„

---

## í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ (ì‹ ê·œ â­)

### ì„¤ê³„ ì›ì¹™
- **Open/Closed Principle**: í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆìŒ
- **Dependency Inversion**: êµ¬ì²´ êµ¬í˜„ì´ ì•„ë‹Œ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
- **Single Responsibility**: ê° ëª¨ë“ˆì€ í•˜ë‚˜ì˜ ë³€ê²½ ì´ìœ ë§Œ ê°€ì§
- **Loose Coupling**: ëª¨ë“ˆ ê°„ ê²°í•©ë„ë¥¼ ë‚®ì¶° ë…ë¦½ì  ë³€ê²½ ê°€ëŠ¥

### í•µì‹¬ íŒ¨í„´
1. **Plugin Architecture**: IImageConverter ì¸í„°í˜ì´ìŠ¤ë¡œ ìƒˆ ë³€í™˜ê¸° ì¶”ê°€
2. **Strategy Pattern**: ISubscriptionStrategyë¡œ ë“±ê¸‰ë³„ ë™ì‘ ë¶„ë¦¬
3. **Event-Driven**: EventBusë¡œ ëª¨ë“ˆ ê°„ ëŠìŠ¨í•œ ê²°í•©
4. **Feature Flags**: ëŸ°íƒ€ì„ì— ê¸°ëŠ¥ ì œì–´, A/B í…ŒìŠ¤íŠ¸ ì§€ì›
5. **Modular Monolith**: ëª…í™•í•œ ê²½ê³„ë¥¼ ê°€ì§„ ëª¨ë“ˆ êµ¬ì¡°

### í™•ì¥ ì˜ˆì œ

**ìƒˆ í¬ë§· ì¶”ê°€ (JXL)**:
```typescript
// 1. í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„
class JXLConverter implements IImageConverter {
  // convert() êµ¬í˜„
}

// 2. ë“±ë¡
pluginRegistry.register(new JXLConverter());

// 3. DB ì„¤ì • (ì½”ë“œ ë³€ê²½ ì—†ìŒ)
UPDATE subscription_tiers
SET features = jsonb_set(features, '{formats}', features->'formats' || '["jxl"]')
WHERE name = 'pro';
```

**ìƒˆ êµ¬ë… ë“±ê¸‰ ì¶”ê°€ (Enterprise)**:
```sql
-- 1. DBì— ë“±ê¸‰ ì¶”ê°€
INSERT INTO subscription_tiers (name, features, price_monthly)
VALUES ('enterprise', '{"formats": [...], "max_batch_size": 1000}', 299.00);

-- 2. ì „ëµ í´ë˜ìŠ¤ ì¶”ê°€
class EnterpriseStrategy implements ISubscriptionStrategy {
  // ë¡œì§ êµ¬í˜„
}

-- 3. íŒ©í† ë¦¬ì— ë“±ë¡
strategyFactory.register('enterprise', new EnterpriseStrategy());
```

ìƒì„¸í•œ í™•ì¥ ê°€ì´ë“œëŠ” [extensibility-guide.md](./extensibility-guide.md) ì°¸ì¡°

---

**ì°¸ê³  ë¬¸ì„œ**:
- [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](database-schema.md) - ìŠ¤í‚¤ë§ˆ ë° RLS ì •ì±…
- [ë³´ì•ˆ ì•„í‚¤í…ì²˜](security-architecture.md) - ë³´ì•ˆ ìœ„í˜‘ ëª¨ë¸ ë° ëŒ€ì‘
- [êµ¬ë… ì„œë¹„ìŠ¤](subscription-service.md) - ê²°ì œ ë° êµ¬ë… ê´€ë¦¬
- [í™•ì¥ì„± ê°€ì´ë“œ](extensibility-guide.md) - ê¸°ëŠ¥ ì¶”ê°€ ë° í™•ì¥ íŒ¨í„´
- [API ëª…ì„¸](../api/payment-api.md) - ê²°ì œ API ìƒì„¸ ìŠ¤í™
